<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Motor Fiscal ‚Äî Diagn√≥stico Estrat√©gico & Proposta</title>

<style>
  :root{
    --p:#0f172a; --a:#2563eb;
    --crit:#ef4444; --alto:#f97316; --medio:#eab308; --ok:#10b981;
    --bg:#f8fafc; --text:#1e293b; --muted:#64748b;
  }
  *{box-sizing:border-box;font-family:Segoe UI,Roboto,system-ui,sans-serif}
  body{margin:0;background:var(--bg);color:var(--text);display:flex;flex-direction:column;height:100vh}
  .hidden{display:none}
  .blur{filter:blur(12px);opacity:.25;pointer-events:none}

  /* LOGIN */
  #login{position:fixed;inset:0;background:var(--p);display:flex;align-items:center;justify-content:center;z-index:9999}
  .login-card{background:#fff;padding:2.5rem;border-radius:14px;width:340px;text-align:center}
  .login-card h2{margin:0 0 1rem}
  .login-card input{width:100%;padding:12px;border:1px solid #cbd5e1;border-radius:10px;font-size:1rem}

  /* HEADER */
  header{background:var(--p);color:#fff;padding:1rem 2rem;display:flex;justify-content:space-between;align-items:center;font-weight:800}

  /* LAYOUT */
  main{flex:1;display:flex;gap:1.5rem;padding:1.5rem;overflow:hidden}
  .left{flex:1;overflow-y:auto;border-right:1px solid #e2e8f0;padding-right:1rem}
  .right{flex:1.35;background:#fff;border-radius:18px;padding:2rem;overflow-y:auto;position:relative;box-shadow:0 6px 30px rgba(0,0,0,.08)}
  .lock{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;font-weight:900;color:var(--muted)}
  .sub{font-size:.85rem;color:var(--muted);line-height:1.35;margin-top:6px}

  /* FORM */
  .form-group{margin-bottom:1.2rem}
  label{display:block;font-size:.75rem;font-weight:900;color:var(--muted);text-transform:uppercase;margin-bottom:.4rem}
  input,textarea{width:100%;padding:12px;border:1px solid #cbd5e1;border-radius:10px;font-size:1rem}
  textarea{resize:vertical}
  .btn{border:none;border-radius:10px;font-weight:900;cursor:pointer;text-transform:uppercase}
  .btn-main{background:var(--ok);color:#fff;padding:16px;width:100%}
  .btn-main:hover{background:#059669;transform:translateY(-2px)}
  .btn-dark{background:var(--p);color:#fff;padding:14px;width:100%;margin-top:1.2rem}

  .checks{
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:8px;
  }
  .checks .item{
    display:flex;gap:8px;align-items:flex-start;
    padding:10px;border:1px solid #e2e8f0;border-radius:10px;background:#f8fafc;
    font-size:.88rem;color:#0f172a;
  }
  .checks .item input{margin-top:3px}
  .checks .item small{display:block;color:var(--muted);font-size:.78rem;line-height:1.25;margin-top:2px}

  /* RESULT */
  .risk{display:inline-block;padding:6px 14px;border-radius:99px;color:#fff;font-weight:900;font-size:.75rem;margin-bottom:10px}
  .box{background:#f1f5f9;border-left:5px solid var(--p);padding:1.2rem;border-radius:10px;margin:14px 0}
  .box h3{margin:0 0 6px 0;font-size:.9rem;text-transform:uppercase;color:var(--muted);letter-spacing:.4px}
  .box p{margin:0;color:#0f172a;line-height:1.5}
  .box ul{margin:8px 0 0 18px;line-height:1.55}
  .box li{margin:6px 0}

  .strats{display:flex;gap:8px;margin:1.1rem 0}
  .strats button{
    flex:1;padding:12px;border:2px solid #e2e8f0;border-radius:10px;background:#fff;font-weight:900;font-size:.85rem
  }
  .strats button.active{border-color:var(--a);background:#eff6ff;color:var(--a)}

  .price{
    background:var(--p);color:#fff;padding:1.4rem;border-radius:16px;text-align:center;margin:1.4rem 0
  }
  .price .val{font-size:2.2rem;font-weight:900;color:#60a5fa;margin-top:6px}
  .split{
    display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:12px;
    text-align:left;
  }
  .pill{
    border:1px solid rgba(255,255,255,.18);
    background:rgba(255,255,255,.04);
    border-radius:12px;padding:10px 12px;
  }
  .pill .t{font-size:.78rem;opacity:.8;text-transform:uppercase;font-weight:800}
  .pill .v{margin-top:4px;font-size:1.05rem;font-weight:900}
  .note{opacity:.75;font-size:.85rem;margin-top:10px;line-height:1.35}

  .legal{
    font-size:.84rem;color:#334155;line-height:1.6;border-top:1px solid #e5e7eb;padding-top:1.2rem
  }
  .legal strong{color:#0f172a}

  @media print{
    header,.left,.btn,.strats,#login{display:none!important}
    body{background:#fff}
    .right{box-shadow:none}
  }
</style>
</head>

<body>

<!-- LOGIN -->
<div id="login">
  <div class="login-card">
    <h2>Acesso Restrito</h2>
    <input type="password" id="pass" placeholder="Senha master" />
    <button class="btn btn-main" style="background:var(--a);margin-top:12px" onclick="login()">Entrar</button>
    <div class="sub">Acesso comercial (front-end). N√£o substitui controle de usu√°rios em backend.</div>
  </div>
</div>

<header>
  <div>FISCAL AI <span style="font-weight:300;opacity:.7">PREMIUM ENGINE</span></div>
  <div style="font-size:.82rem;opacity:.85">index √∫nico</div>
</header>

<main id="app" class="hidden">
  <section class="left">
    <div class="form-group">
      <label>Contribuinte</label>
      <input id="name" placeholder="Empresa / Pessoa F√≠sica" />
    </div>

    <div class="form-group">
      <label>Valor do passivo (R$)</label>
      <input id="value" placeholder="R$ 0,00" oninput="mask(this)" />
    </div>

    <div class="form-group">
      <label>Gatilhos / contexto do caso</label>
      <div class="checks">
        <div class="item">
          <input type="checkbox" id="x_exec" />
          <div>
            <div><b>Execu√ß√£o fiscal em andamento</b></div>
            <small>Ind√≠cio de judicializa√ß√£o e possibilidade de atos constritivos.</small>
          </div>
        </div>

        <div class="item">
          <input type="checkbox" id="x_penhora" />
          <div>
            <div><b>Penhora / constri√ß√£o</b></div>
            <small>Risco patrimonial efetivo (valores/bens/receb√≠veis).</small>
          </div>
        </div>

        <div class="item">
          <input type="checkbox" id="x_sisbajud" />
          <div>
            <div><b>Contas bloqueadas (SISBAJUD)</b></div>
            <small>Impacto direto no caixa e opera√ß√£o.</small>
          </div>
        </div>

        <div class="item">
          <input type="checkbox" id="x_bens" />
          <div>
            <div><b>Bloqueio de bens / restri√ß√£o</b></div>
            <small>Ex.: restri√ß√£o de ve√≠culo, indisponibilidade, etc.</small>
          </div>
        </div>

        <div class="item">
          <input type="checkbox" id="x_certidao" />
          <div>
            <div><b>Precisa de certid√£o negativa</b></div>
            <small>Regularidade fiscal como requisito pr√°tico do neg√≥cio.</small>
          </div>
        </div>

        <div class="item">
          <input type="checkbox" id="x_licit" />
          <div>
            <div><b>Participa de licita√ß√£o / contrato p√∫blico</b></div>
            <small>Risco operacional por exig√™ncias de habilita√ß√£o e regularidade.</small>
          </div>
        </div>

        <div class="item">
          <input type="checkbox" id="x_regul" />
          <div>
            <div><b>Regulamenta√ß√£o com √≥rg√£o p√∫blico</b></div>
            <small>Ex.: ANTT, IBAMA, prefeitura, autarquia, conselho, etc.</small>
          </div>
        </div>

        <div class="item">
          <input type="checkbox" id="x_fat" />
          <div>
            <div><b>Baixa de faturamento / crise de caixa</b></div>
            <small>Agrava urg√™ncia e necessidade de previsibilidade.</small>
          </div>
        </div>

        <div class="item">
          <input type="checkbox" id="x_prot" />
          <div>
            <div><b>Protesto / restri√ß√£o cadastral</b></div>
            <small>Impacto comercial e reputacional (Serasa/Cart√≥rio).</small>
          </div>
        </div>

        <div class="item">
          <input type="checkbox" id="x_prazos" />
          <div>
            <div><b>Prazos urgentes / intima√ß√£o recente</b></div>
            <small>Press√£o temporal real (pode elevar risco).</small>
          </div>
        </div>
      </div>
      <div class="sub">Esses itens n√£o ‚Äúescolhem risco‚Äù. Eles s√≥ alimentam a classifica√ß√£o autom√°tica.</div>
    </div>

    <div class="form-group">
      <label>Relato do problema (texto livre)</label>
      <textarea id="text" rows="7" placeholder="Descreve os fatos: sisbajud, penhora, oficial de justi√ßa, licita√ß√£o, certid√£o, baixa de faturamento..."></textarea>
      <div class="sub">O motor usa palavras-chave + gatilhos para classificar o risco e gerar a fundamenta√ß√£o.</div>
    </div>

    <button class="btn btn-main" onclick="analisar()">Analisar estrat√©gias ‚ö°</button>
  </section>

  <section class="right">
    <div id="lock" class="lock">üîí Aguardando an√°lise t√©cnica</div>

    <div id="out" class="blur">
      <span id="risk" class="risk">--</span>

      <div class="box">
        <h3>S√≠ntese do diagn√≥stico</h3>
        <p id="sum" style="font-weight:900;font-size:1.05rem"></p>
        <p id="det" style="margin-top:8px;color:#334155"></p>
      </div>

      <label>Estrat√©gia</label>
      <div class="strats">
        <button id="s-cons" onclick="setStrat('cons')">Conservadora</button>
        <button id="s-reco" class="active" onclick="setStrat('reco')">Recomendada</button>
        <button id="s-agre" onclick="setStrat('agre')">Agressiva</button>
      </div>

      <div class="box">
        <h3>O que vamos fazer</h3>
        <p id="str-desc" style="font-weight:700"></p>
        <div id="acts"></div>
      </div>

      <div class="price">
        <div style="opacity:.85;font-size:.82rem;text-transform:uppercase;font-weight:900">Investimento mensal (12 meses)</div>
        <div class="val" id="mval">R$ 0,00</div>
        <div id="tval" style="opacity:.7;margin-top:6px"></div>

        <div class="split">
          <div class="pill">
            <div class="t">Assessoria padr√£o</div>
            <div class="v" id="assv">R$ 199,99</div>
          </div>
          <div class="pill">
            <div class="t">Opera√ß√£o t√©cnica</div>
            <div class="v" id="opv">R$ 0,00</div>
          </div>
        </div>

        <div class="note">
          A assessoria padr√£o √© fixa. O restante comp√µe a opera√ß√£o t√©cnica (execu√ß√£o do plano, an√°lises, rotas e acompanhamento).
        </div>
      </div>

      <div class="legal">
        <strong>Fundamenta√ß√£o t√©cnica aplicada</strong>
        <div id="legal" style="margin-top:10px"></div>
        <div style="margin-top:12px;opacity:.9">
          <strong>Notas gerais:</strong> Parecer preliminar, sujeito a auditoria documental e checagens em sistemas oficiais. A rota final depende da fase (administrativa x judicial), natureza do cr√©dito e riscos operacionais. N√£o h√° promessa de resultado.
        </div>
      </div>

      <button class="btn btn-dark" onclick="window.print()">Imprimir parecer</button>
    </div>
  </section>
</main>

<script>
  const PASS = "jos√©falcao";
  const ASSESSORIA_FIXA = 199.99; // mensal fixa

  let strat = "reco";
  let risk = "MEDIO";

  // Palavras-chave (amplia conforme tua opera√ß√£o)
  const KW = {
    crit: [
      "sisbajud","bacenjud","bloqueio","conta bloqueada","contas bloqueadas","penhora","arresto","sequestro",
      "leilao","leil√£o","oficial de justi√ßa","constricao","constri√ß√£o","indisponibilidade","restricao judicial"
    ],
    alto: [
      "execucao fiscal","execu√ß√£o fiscal","execucao","execu√ß√£o","ajuizada","cda","citacao","cita√ß√£o","intimacao","intima√ß√£o",
      "protesto","serasa","spc","cartorio","cart√≥rio","divida ativa","d√≠vida ativa","renajud"
    ],
    medio: [
      "cnd","certidao","certid√£o","cpd-en","licita√ß√£o","licitacao","regularidade fiscal","antt","ibama",
      "prefeitura","autarquia","conselho","parcelamento","simples nacional","exclusao","exclus√£o","reenquadramento",
      "baixa de faturamento","queda de faturamento","crise de caixa","sem caixa","fluxo de caixa"
    ]
  };

  // Estrat√©gias: descri√ß√£o + atos (bullets) + multiplicador comercial
  const STR = {
    cons: {
      m: 1.00,
      desc: "Rota direta de regulariza√ß√£o e previsibilidade, com m√≠nima fric√ß√£o e foco em continuidade do neg√≥cio.",
      atos: [
        "Triagem do passivo e organiza√ß√£o por prioridade (caixa, certid√£o, riscos imediatos).",
        "Defini√ß√£o do caminho de regulariza√ß√£o/negocia√ß√£o mais aderente ao cen√°rio.",
        "Checklist de pend√™ncias que travam regularidade e impactos operacionais.",
        "Acompanhamento mensal e ajustes conforme evolu√ß√£o do caso."
      ]
    },
    reco: {
      m: 1.35,
      desc: "Atua√ß√£o t√©cnica completa orientada a risco: estabiliza o cen√°rio e melhora o custo total com governan√ßa do caso.",
      atos: [
        "Mapeamento de risco (judicializa√ß√£o, travas, constri√ß√µes) e plano por etapas.",
        "Organiza√ß√£o documental e narrativa t√©cnica para sustentar pedidos e negocia√ß√µes.",
        "Estrat√©gia para reduzir press√£o operacional e recuperar previsibilidade.",
        "Monitoramento e replanejamento mensal com base em eventos do caso."
      ]
    },
    agre: {
      m: 1.70,
      desc: "Interven√ß√£o r√°pida e intensa para conter impacto operacional e recuperar margem de manobra (quando justificado).",
      atos: [
        "Resposta imediata para conter dano (prioridade: caixa e opera√ß√£o).",
        "Atua√ß√£o t√©cnica refor√ßada com cad√™ncia curta e decis√µes r√°pidas.",
        "Estrutura√ß√£o agressiva por etapas: conter ‚Üí estabilizar ‚Üí otimizar condi√ß√£o.",
        "Acompanhamento pr√≥ximo e ajustes cont√≠nuos do plano."
      ]
    }
  };

  // Fundamenta√ß√£o din√¢mica por estrat√©gia + risco
  const BASE_NORM = [
    "CTN, art. 151: hip√≥teses de suspens√£o da exigibilidade (ex.: parcelamento; e, no contencioso, medidas cuja efic√°cia dependa de decis√£o competente).",
    "Lei n¬∫ 6.830/80 (LEF): rito da execu√ß√£o fiscal e atos t√≠picos (cita√ß√£o, penhora, avalia√ß√£o e expropria√ß√£o).",
    "CPC (aplica√ß√£o subsidi√°ria): tutela de urg√™ncia e instrumentos processuais para conten√ß√£o de risco, quando cab√≠veis.",
    "A rota final depende da fase de cobran√ßa, natureza do cr√©dito e documenta√ß√£o dispon√≠vel."
  ];

  const FUND = {
    cons: {
      MEDIO: [
        "Foco em regulariza√ß√£o e previsibilidade: reduzir atrito e manter regularidade operacional.",
        "Prioriza√ß√£o de medidas que evitem escalada do passivo e travas de certid√£o/contratos."
      ],
      ALTO: [
        "Com sinais de execu√ß√£o/press√£o, prioriza estabiliza√ß√£o e regulariza√ß√£o estruturada, com m√≠nimo lit√≠gio.",
        "√änfase em controle de prazos e redu√ß√£o de risco operacional por gest√£o do caso."
      ],
      CRITICO: [
        "Com risco imediato (bloqueio/penhora), atua para reduzir impacto operacional sem prometer revers√£o autom√°tica.",
        "Plano de conten√ß√£o + reorganiza√ß√£o do cen√°rio para viabilizar regulariza√ß√£o com previsibilidade."
      ]
    },
    reco: {
      MEDIO: [
        "Inclui auditoria t√©cnica do passivo (origem, composi√ß√£o, encargos) e sele√ß√£o da rota mais eficiente.",
        "Objetivo: melhorar custo total e reduzir vulnerabilidades sem assumir riscos desnecess√°rios."
      ],
      ALTO: [
        "Adiciona an√°lise de risco processual e consist√™ncia dos atos/t√≠tulos, sem presun√ß√£o de nulidade.",
        "Objetivo: conter escalada (restri√ß√µes/penhoras) e reconstruir controle do cen√°rio para regulariza√ß√£o."
      ],
      CRITICO: [
        "Prioriza conten√ß√£o + estabiliza√ß√£o: reduzir dano operacional e recuperar governan√ßa do caso.",
        "Estrutura medidas compat√≠veis com o rito aplic√°vel e evid√™ncias documentais dispon√≠veis."
      ]
    },
    agre: {
      MEDIO: [
        "S√≥ √© indicada com justificativa concreta (janela estrat√©gica, travas severas ou escalada iminente).",
        "Busca acelerar controle do cen√°rio com medidas mais incisivas e cad√™ncia curta."
      ],
      ALTO: [
        "Com execu√ß√£o e escalada, assume postura de interven√ß√£o r√°pida para recuperar margem de manobra.",
        "Pode envolver medidas de urg√™ncia quando cab√≠veis, sempre com base documental."
      ],
      CRITICO: [
        "Resposta imediata para conter dano (caixa/operacional) e atuar pelo caminho mais r√°pido defens√°vel.",
        "Atua√ß√£o intensa orientada a risco, com reavalia√ß√£o cont√≠nua conforme eventos do caso."
      ]
    }
  };

  function login(){
    if(document.getElementById("pass").value === PASS){
      document.getElementById("login").style.display = "none";
      document.getElementById("app").classList.remove("hidden");
    }
  }

  function mask(i){
    let v=i.value.replace(/\D/g,"");
    v=(v/100).toFixed(2).replace(".",",");
    v=v.replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1.");
    i.value="R$ "+v;
  }

  function analyzeTextScore(txt){
    const t = (txt||"").toLowerCase();
    let score = 0;
    if(KW.crit.some(k=>t.includes(k))) score += 6;
    if(KW.alto.some(k=>t.includes(k))) score += 3;
    if(KW.medio.some(k=>t.includes(k))) score += 1;
    return score;
  }

  function analyzeChecksScore(){
    let s = 0;
    const exec = document.getElementById("x_exec").checked;
    const penh = document.getElementById("x_penhora").checked;
    const sisb = document.getElementById("x_sisbajud").checked;
    const bens = document.getElementById("x_bens").checked;
    const cert = document.getElementById("x_certidao").checked;
    const lic  = document.getElementById("x_licit").checked;
    const reg  = document.getElementById("x_regul").checked;
    const fat  = document.getElementById("x_fat").checked;
    const prot = document.getElementById("x_prot").checked;
    const praz = document.getElementById("x_prazos").checked;

    if(sisb) s += 7;
    if(penh) s += 6;
    if(exec) s += 4;
    if(bens) s += 3;
    if(cert) s += 2;
    if(lic)  s += 2;
    if(reg)  s += 2;
    if(prot) s += 2;
    if(fat)  s += 2;
    if(praz) s += 2;

    // combos que elevam risco
    if(exec && penh) s += 4;
    if(exec && sisb) s += 4;

    return s;
  }

  function classificarRisco(totalScore){
    // Heur√≠stica simples e ‚Äúvend√°vel‚Äù
    if(totalScore >= 12) return "CRITICO";
    if(totalScore >= 6) return "ALTO";
    return "MEDIO";
  }

  function setRiskUI(r){
    const el=document.getElementById("risk");
    el.innerText="RISCO " + (r==="CRITICO" ? "CR√çTICO" : r);
    el.style.background = r==="CRITICO" ? "var(--crit)" : r==="ALTO" ? "var(--alto)" : "var(--medio)";

    const sum=document.getElementById("sum");
    const det=document.getElementById("det");

    if(r==="CRITICO"){
      sum.innerText="ALTA VULNERABILIDADE OPERACIONAL E PATRIMONIAL";
      det.innerText="H√° sinais de constri√ß√£o/risco imediato (bloqueio/penhora/contas bloqueadas). Prioridade: conter impacto e recuperar previsibilidade.";
    } else if(r==="ALTO"){
      sum.innerText="PRESS√ÉO JUDICIAL / TRAVAS OPERACIONAIS RELEVANTES";
      det.innerText="H√° sinais de judicializa√ß√£o e/ou restri√ß√µes que tendem a escalar. Prioridade: estabilizar cen√°rio e construir rota de regulariza√ß√£o com controle.";
    } else {
      sum.innerText="CEN√ÅRIO CONTROL√ÅVEL COM PLANEJAMENTO";
      det.innerText="Sem sinais cr√≠ticos evidentes. Prioridade: previsibilidade, regularidade e melhor condi√ß√£o econ√¥mica global.";
    }
  }

  function fmtList(items){
    return `<ul>${items.map(i=>`<li>${i}</li>`).join("")}</ul>`;
  }

  function renderActs(){
    const a = STR[strat].atos;
    document.getElementById("acts").innerHTML = fmtList(a);
  }

  function renderLegal(){
    const rKey = risk; // MEDIO/ALTO/CRITICO
    let html = "";

    // Bloco especial: execu√ß√£o + penhora/bloqueio (tua exig√™ncia)
    const exec = document.getElementById("x_exec").checked;
    const penh = document.getElementById("x_penhora").checked;
    const sisb = document.getElementById("x_sisbajud").checked;

    if(exec && (penh || sisb)){
      html += `
        <div class="box" style="border-left-color: var(--a); background:#eef2ff">
          <h3>Ponto t√©cnico relevante</h3>
          <p>
            Em cen√°rio de <b>execu√ß√£o fiscal</b> com <b>penhora/bloqueio</b>, √© comum que, ap√≥s a cita√ß√£o/intima√ß√£o,
            o contribuinte seja instado a <b>pagar, parcelar ou garantir o d√©bito</b>.
            Seguir um desses caminhos tende a facilitar a <b>demonstra√ß√£o de boa-f√©</b> e de capacidade de organiza√ß√£o do passivo,
            o que √© elemento importante para sustentar tratativas e buscar condi√ß√µes mais adequadas conforme o caso.
          </p>
        </div>
      `;
    }

    html += `
      <div style="margin-top:10px">
        <strong>Aplica√ß√£o ao caso (estrat√©gia ${strat.toUpperCase()} / risco ${rKey}):</strong>
        ${fmtList(FUND[strat][rKey])}
      </div>
      <div style="margin-top:10px">
        <strong>Base normativa e t√©cnica:</strong>
        ${fmtList(BASE_NORM)}
      </div>
    `;

    document.getElementById("legal").innerHTML = html;
  }

  function parseBRL(input){
    const raw = (input||"").replace(/[^\d]/g,"");
    return (parseFloat(raw)||0)/100;
  }

  function calcPricing(valorPassivo){
    // taxa interna por risco (n√£o aparece)
    const rate = (risk==="CRITICO") ? 0.0045 : (risk==="ALTO") ? 0.0032 : 0.0020;
    const fixed = (risk==="CRITICO") ? 1800 : (risk==="ALTO") ? 900 : 450;

    let mensalBase = (valorPassivo * rate) + fixed;
    let mensal = mensalBase * STR[strat].m;

    // m√≠nimo mensal pra n√£o ‚Äúachatar‚Äù
    const minMensal = 900;
    if(mensal < minMensal) mensal = minMensal;

    // separar assessoria fixa e opera√ß√£o t√©cnica
    const assess = ASSESSORIA_FIXA;
    const oper = Math.max(0, mensal - assess);

    return { mensal, assess, oper, total: mensal * 12 };
  }

  function analisar(){
    const vStr = document.getElementById("value").value;
    if(!vStr || vStr === "R$ 0,00") return alert("Insere o valor do passivo.");

    document.getElementById("lock").style.display="none";
    document.getElementById("out").classList.remove("blur");

    calcularTudo();
  }

  function setStrat(s){
    strat=s;
    document.querySelectorAll(".strats button").forEach(b=>b.classList.remove("active"));
    document.getElementById("s-"+s).classList.add("active");
    calcularTudo();
  }

  function calcularTudo(){
    const valor = parseBRL(document.getElementById("value").value);
    const txtScore = analyzeTextScore(document.getElementById("text").value);
    const chkScore = analyzeChecksScore();
    const totalScore = txtScore + chkScore;

    risk = classificarRisco(totalScore);

    setRiskUI(risk);

    // estrat√©gia + atos
    document.getElementById("str-desc").innerText = STR[strat].desc;
    renderActs();

    // pre√ßo
    const p = calcPricing(valor);
    document.getElementById("mval").innerText = p.mensal.toLocaleString("pt-BR",{style:"currency",currency:"BRL"});
    document.getElementById("tval").innerText = "Total contrato (12 meses): " + p.total.toLocaleString("pt-BR",{style:"currency",currency:"BRL"});
    document.getElementById("assv").innerText = p.assess.toLocaleString("pt-BR",{style:"currency",currency:"BRL"});
    document.getElementById("opv").innerText = p.oper.toLocaleString("pt-BR",{style:"currency",currency:"BRL"});

    // fundamenta√ß√£o
    renderLegal();
  }
</script>

</body>
</html>
